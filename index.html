<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Web Tón</title>
    <style>
        body { display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; font-family: sans-serif; background-color: #f9f9f9; }
        .box { border: 3px solid #333; padding: 50px; text-align: center; border-radius: 20px; background: white; box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        h1 { font-size: 3em; color: #222; margin-bottom: 30px; }
        .container { display: flex; flex-direction: column; align-items: center; gap: 25px; }
        .row { display: flex; align-items: center; font-size: 250%; }
        input[type="checkbox"] { width: 45px; height: 45px; accent-color: #28a745; margin-right: 20px; cursor: pointer; }
        label { cursor: pointer; font-weight: bold; }
        #status { margin-top: 30px; font-size: 1.2em; color: #555; padding: 10px; border-top: 1px solid #eee; }
    </style>
</head>
<body>

<div class="box">
    <h1>Ai đang trong web tón?</h1>
    <div class="container">
        <div class="row">
            <input type="checkbox" id="Duyên" onclick="updateFirebase(this)">
            <label for="Duyên">Duyên</label>
        </div>
        <div class="row">
            <input type="checkbox" id="Hân" onclick="updateFirebase(this)">
            <label for="Hân">Hân</label>
        </div>
    </div>
    <div id="status">Đang kết nối dữ liệu...</div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    // ĐÂY LÀ ĐOẠN MÃ COPY TỪ ẢNH CỦA BẠN ĐÃ ĐƯỢC DÁN VÀO:
    const firebaseConfig = {
        apiKey: "AIzaSyCclrkD8hbXXMv3iHcV48IazSym_g-swMU",
        authDomain: "web-ton-db.firebaseapp.com",
        databaseURL: "https://web-ton-db-default-rtdb.firebaseio.com",
        projectId: "web-ton-db",
        storageBucket: "web-ton-db.firebasestorage.app",
        messagingSenderId: "660819205196",
        appId: "1:660819205196:web:38532bda317e978f4c28e9",
        measurementId: "G-XPFWPT576Q"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const dataRef = ref(db, 'selection');

    window.updateFirebase = (el) => {
        const name = el.checked ? el.id : "Trống";
        document.querySelectorAll('input').forEach(i => { if(i !== el) i.checked = false; });
        
        set(dataRef, {
            chosen: name,
            lastUpdate: new Date().toLocaleTimeString('vi-VN')
        });
    };

    onValue(dataRef, (snapshot) => {
        const data = snapshot.val();
        if (data) {
            document.getElementById('status').innerText = "Tương tác gần nhất: " + data.chosen + " (" + data.lastUpdate + ")";
            document.querySelectorAll('input').forEach(i => {
                i.checked = (i.id === data.chosen);
            });
        }
    });
</script>

</body>
</html>
